# エンドポイント設計チェックリスト

新しいエンドポイントを設計する際に、以下の項目をチェックする。

## リソース設計

- [ ] リソース名は複数形の名詞か?
- [ ] URIに動詞を含めていないか?
- [ ] ケバブケース（kebab-case）を使用しているか?
- [ ] バージョニングが含まれているか?（`/api/v1/`）
- [ ] 階層は2階層までに制限されているか?
- [ ] パスパラメータは適切に使用されているか?

## HTTPメソッド

- [ ] 適切なHTTPメソッドを使用しているか?
  - GET: リソース取得
  - POST: リソース作成
  - PUT: リソース全体更新
  - PATCH: リソース部分更新
  - DELETE: リソース削除
- [ ] GETメソッドで副作用のある操作を行っていないか?
- [ ] POSTメソッドで作成以外の操作を行っていないか?

## ステータスコード

- [ ] 成功時のステータスコードは適切か?
  - GET/PUT/PATCH: 200 OK
  - POST: 201 Created
  - DELETE: 204 No Content
- [ ] エラー時のステータスコードは適切か?
  - バリデーションエラー: 400 Bad Request
  - 認証エラー: 401 Unauthorized
  - 認可エラー: 403 Forbidden
  - リソース未発見: 404 Not Found
  - リソース競合: 409 Conflict
  - サーバーエラー: 500 Internal Server Error

## リクエスト/レスポンス

- [ ] リクエストボディはPydanticスキーマで定義されているか?
- [ ] レスポンスボディはPydanticスキーマで定義されているか?
- [ ] フィールド名はキャメルケースか?（JSON形式）
- [ ] 日時フィールドはISO 8601形式（`createdAt`、`updatedAt`）か?
- [ ] 必須フィールドと任意フィールドが明確か?

## エラーハンドリング

- [ ] エラーレスポンスは構造化されているか?
- [ ] エラーコード、メッセージ、詳細情報を含めているか?
- [ ] 例外は適切にハンドリングされているか?
- [ ] 機密情報をエラーメッセージに含めていないか?

## セキュリティ

- [ ] 認証が必要なエンドポイントには認証を実装しているか?
- [ ] 認可（権限チェック）を実装しているか?
- [ ] 入力バリデーションを実装しているか?
- [ ] SQLインジェクション対策を実施しているか?（ORMを使用）
- [ ] XSS対策を実施しているか?（入力値をエスケープ）
- [ ] レート制限を実装しているか?

## ページネーション・フィルタリング

- [ ] コレクションを返すエンドポイントでページネーションを実装しているか?
- [ ] フィルタリングパラメータは適切に設計されているか?
- [ ] ソート機能は必要か?実装されているか?
- [ ] 総件数を返しているか?（ページネーション情報）

## ドキュメント

- [ ] OpenAPI仕様書に記載されているか?
- [ ] エンドポイントのsummaryを記載しているか?
- [ ] リクエスト/レスポンスの例を記載しているか?
- [ ] エラーレスポンスの仕様を記載しているか?
- [ ] 詳細なdocstringを記載しているか?

## テスト

- [ ] 正常系のテストを書いているか?
- [ ] 異常系のテストを書いているか?（404、400など）
- [ ] 認証・認可のテストを書いているか?
- [ ] バリデーションのテストを書いているか?

## その他

- [ ] 既存のエンドポイントとの一貫性はあるか?
- [ ] 破壊的変更ではないか?（既存クライアントが破損しないか）
- [ ] パフォーマンスは十分か?
- [ ] コードレビューを受けたか?
